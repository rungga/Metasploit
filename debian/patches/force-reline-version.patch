From: Sophie Brun <sophie@offensive-security.com>
Date: Wed, 24 Jun 2020 09:23:54 +0200
Subject: Force reline version to libruby reline version

Last-Update: 2021-06-21

Description: Force reline version to 0.1.5 because it's the default version
shipped by ruby 2.7. If we don't force the version, bundler installs the
latest available version of reline gem and it will breaks msfdb init
(see https://bugs.kali.org/view.php?id=6517)
---
 metasploit-framework.gemspec | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/metasploit-framework.gemspec b/metasploit-framework.gemspec
index b7d5780..6b85d3b 100644
--- a/metasploit-framework.gemspec
+++ b/metasploit-framework.gemspec
@@ -214,8 +214,11 @@ Gem::Specification.new do |spec|
   spec.add_runtime_dependency 'hrr_rb_ssh-ed25519'
   # Needed for irb internal command
   spec.add_runtime_dependency 'irb'
-  # Lock reline version until Fiddle concerns are addressed
-  spec.add_runtime_dependency 'reline', '0.2.5'
+  # Force reline version to 0.1.5 because it's the default version shipped
+  # by ruby 2.7.2 If we don't force the version, bundler installs the
+  # latest available version of reline gem and it will
+  # breaks msfdb init (see https://bugs.kali.org/view.php?id=6517)
+  spec.add_runtime_dependency 'reline', '0.1.5'
 
   # AWS enumeration modules
   spec.add_runtime_dependency 'aws-sdk-s3'
